#### スタートアップルーチン

- `Windows` や `Linux/UNIX` の環境で C を使ってプログラミングするときは，`main 関数`以降をコーディングするが，プログラムは `main 関数`から始まっているのではない．その前段階として，`スタートアップ・ルーチン`というものが存在する

1. `電源が入ったり，リセット・ボタンが押される` = 「今の状態がどうあれ、`初期状態から動作せよ`」という強制的な指令（割り込み）= 組み込み機器が動き始める
2. マイコンはある`固定のアドレス`（`割り込みベクトル領域`と呼ばれる特別なメモリ領域のうち，`リセットに割り当てられたベクトル番地`）の内容を読み込む (そこに書かれている内容はマイコンによって異なり，`ジャンプ先のアドレス(1)`であったり，`短いプログラム(2)`であったりする)

- (1) そのアドレスに制御を移す
- (2) そこに書かれているプログラムを実行(実質的に、あるアドレスに制御を移すことと同じ)

3. `スタックの設定`、`プログラミの実行に必要なデータの設定`、`マイコンの動作モードの設定`、`ハードウェアの初期化`、`ハードウェアの自己診断`などの`スタートアップ・ルーチン`を行う
4. `main 関数`を呼び出す
5. `スタートアップ・ルーチン`に戻り、後処理を行うことが多い

- Windows や Linux/UNIX ではアプリケーションを開発するときにに`スタートアップ・ルーチン`を意識しなくても良い。これは、実行環境は常に同じ（毎回変更する必要がない）なので、C コンパイラが自動的に`スタートアップ・ルーチン`をリンクしているからである。（UNIX 系で言うと、`スタートアップ・ルーチン`は標準ライブラリといっしょに **`crt0.o`** と言う名前で存在する）

```text
・スタックの設定（変数のための RAM 領域）
・プログラムの実行に必要なデータの設定
　  ・ROM領域からRAM領域への初期値データの転送
　  ・初期値を持たないメモリ領域の0クリア
・マイコンの動作モードの設定
　  ・マイコン内蔵の周辺機能を使用するための各種レジスタの初期化
　  ・割り込み許可設定
・ハードウェアの初期化
・ハードウェアの自己診断
```

- プログラムの実行に必要なものとしては，スタック以外にも定数やグローバル変数がある．これらを初期化もしくは 0 クリアする必要がある．
- 定数の一部の値は ROM を参照して RAM にコピーしてやる必要があるかもしれない．それが，ROM 領域から RAM 領域への初期値データの転送．
- **`4`** ではスタートアップ・ルーチンから C プログラムの `main 関数`を直接呼び出すように書いてるが，C 言語の標準ライブラリを使用する場合は，`main 関数`を呼び出す前に`標準ライブラリの初期化`を実行する必要がある．そして，ソフトウェア自身の実行だけでなく`マイコンやそのほかのハードウェアを使用するための初期化`も必要になる（これらの初期化は，マイコンやハードウェアのマニュアルを参照しながらコーディングする）
